# Twice-Thinking Agent Skill

## Skill 描述

**Twice-Thinking** 是一个 AI Agent 专用 Skill，通过深度追问机制来澄清和细化用户需求，避免因需求不明确导致的开发返工。

## 核心理念

用户提出的需求往往是模糊的、不完整的。Twice-Thinking 通过系统化的多轮追问，把模糊需求转化成清晰、可执行的需求文档。

## Skill 能力

### 1. 需求分析（Analyze）

```
输入：用户的原始请求
输出：初步分析 + 追问计划
```

**能做什么：**
- 识别需求的主要意图（创建/修改/学习/集成）
- 检测模糊词、歧义表达、缺失的关键信息
- 判断需要追问的维度（目标/场景/功能/技术/用户/边界）
- 生成 3-5 个初始追问

**追问维度清单：**
- [ ] 目标确认 - 解决什么问题？达到什么目的？
- [ ] 使用场景 - 在什么环境下用？有什么约束？
- [ ] 功能范围 - 必须/可选的功能？优先级？
- [ ] 技术细节 - 技术栈、集成方式、数据格式？
- [ ] 用户体验 - 用户角色、使用频率、操作流程？
- [ ] 边界条件 - 性能要求、兼容性、扩展性？
- [ ] 成功标准 - 如何判断完成？怎么测试？

### 2. 追问跟进（Follow-up）

```
输入：会话ID + 问题key + 用户回答
输出：下一轮追问 或 需求总结
```

**追问策略：**
- 从简单到复杂，先大局后细节
- 每次只问 1-2 个问题，避免信息过载
- 每个问题都有明确的目的
- 记录用户回答，基于回答生成新问题
- 7 个维度覆盖完毕或用户主动停止时生成总结

### 3. 需求总结（Summarize）

```
输入：会话ID
输出：结构化的需求文档
```

**输出格式：**

```markdown
# [项目名称] 需求文档

## 1. 基本信息
- **需求类型**: [创建/修改/学习/集成/其他]
- **迭代次数**: N轮对话
- **澄清日期**: YYYY-MM-DD

## 2. 原始需求
> 用户的原始请求内容

## 3. 需求理解
### 3.1 主要目标
用户真正想解决什么问题？达到什么目的？

### 3.2 目标用户
- 用户角色：
- 预期规模：
- 使用频率：
- 使用场景：

### 3.3 功能范围
#### 必须实现
- 功能1：
- 功能2：
- ...

#### 可选功能
- 功能1：
- 功能2：
- ...

#### 明确不做的
- 功能1：
- 功能2：
- ...

### 3.4 技术要求
- 技术栈：
- 集成要求：
- 数据格式：
- 环境要求：

### 3.5 用户体验
- 界面风格：
- 操作流程：
- 性能要求：
- 兼容性：

### 3.6 边界条件
- 性能指标：
- 安全考虑：
- 扩展性：
- 合规性：

### 3.7 成功标准
- 功能完整性：
- 用户体验指标：
- 性能标准：
- 测试要求：

## 4. 已澄清的关键点
- 维度1: 内容
- 维度2: 内容
- ...

## 5. 对话历史
### 迭代1
- 问题: ...
- 回答: ...

### 迭代2
- 问题: ...
- 回答: ...

...

## 6. 下一步建议
1. ...
2. ...
3. ...
```

## 对话流程示例

### 完整流程示例

```
用户：开发一个应用

AI(Twice-Thinking Skill):
【需求分析】
- 意图：创建
- 需要追问的维度：目标/场景/功能/技术/用户
- 模糊点："一个应用"太笼统

【初始追问】
1. 这个应用主要解决什么问题？是提高效率还是解决具体痛点？
2. 目标用户是谁？是企业用户还是个人用户？
3. 你期望这是个 Web 应用、桌面应用还是移动应用？

用户：做一个效率工具，给团队用的，桌面应用

AI(Twice-Thinking Skill):
【记录】已回答：桌面应用，团队用，效率工具

【追问跟进】
4. 团队大概有多少人？
5. 主要的使用场景是什么？比如项目管理、文档协作还是其他？
6. 你有哪些特别的需求吗？比如数据同步、离线使用、权限管理？

用户：5-10人，主要是项目管理和文档协作。需要数据同步，不需要权限管理太复杂

AI(Twice-Thinking Skill):
【记录】已回答：5-10人，项目管理和文档协作，数据同步，权限不复杂

【追问跟进】
7. 期望支持什么文件格式？需要和哪些现有系统集成？
8. 界面风格有什么偏好吗？现代简约还是传统丰富？

用户：支持常见的 Office 格式，和公司现有的 SharePoint 集成

AI(Twice-Thinking Skill):
【记录】已回答：Office格式，SharePoint集成

【分析】7个维度已覆盖，生成总结

【需求总结】
(生成完整的需求文档，见上面的格式)
```

## Skill 优势

1. **避免返工** - 需求明确后才开发，减少方向错误
2. **发现盲点** - 通过追问发现用户自己没考虑的边界
3. **建立信任** - 通过逐步对话建立专业印象
4. **可追溯** - 完整的对话历史和推理过程
5. **结构化** - 输出规范的需求文档，便于后续参考

## 使用方式

### 方式1：System Prompt 集成

在 AI 的 system prompt 中配置：

```
当用户提出以下类型的需求时，使用 Twice-Thinking Skill：

【触发场景】
- 创建新应用/功能
- 修改现有功能
- 集成第三方服务
- 技术选型咨询
- 学习新技术或概念

【处理流程】
1. 调用 Analyze 能力，分析需求并生成初始追问
2. 逐步使用 Follow-up 能力收集用户回答
3. 信息足够时调用 Summarize 生成需求文档
4. 将生成的内容展示给用户确认，收到确认后结束 Skill 处理

【输出要求】
- 需求文档必须结构化（使用 markdown）
- 每个迭代的问题和回答都要记录
- 7个维度都必须覆盖到
- 最终需求要包含"下一步建议"
```

### 方式2：手动 Agent 调用

适合在支持 Agent/Workflow 的平台上：

1. 创建 Twice-Thinking Agent 实例
2. 当识别到触发场景时，将请求转发给这个 Agent
3. Agent 按照对话流程处理
4. 完成后将结果返回

### 方式3：代码库集成

在开发项目中配置 AI 辅助：

1. 识别需求相关的文件改动
2. 触发 Twice-Thinking Skill 分析需求
3. 生成 PR template 或技术方案文档

## 版本

- **v0.1.0** - 初始版本，支持基础的需求追问能力

## 贡献

这个 Skill 的设计是开放的，可以根据实际使用反馈持续改进。

改进方向：
- 支持更多追问维度
- 智能推断（根据用户回答自动判断是否需要继续追问）
- 需求模板库（针对不同类型的需求）
- 风险检测（在需求中标记可能的实现难点）
